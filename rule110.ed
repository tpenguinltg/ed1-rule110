$a

.
-t.
.g/^\(.\).*\(.\)$/s//\2&\1/
.g/^.$/s//&&&/
s/./&\
/g
d
?^$?+,$--g/^/+,++t.\
--,.j\
s/\(111\)\|\(100\)\|\(000\)/0/\
s/\(110\)\|\(101\)\|\(011\)\|\(010\)\|\(001\)/1/
$-,$d
?^$?,$jp
w
!exec ed % < %
q

# DATA
00000000000000000000000000000100
